# Домашнее задание к занятию "5.1. Введение в виртуализацию. Типы и функции гипервизоров. Обзор рынка вендоров и областей применения."

## Задача 1

Опишите кратко, как вы поняли: в чем основное отличие полной (аппаратной) виртуализации, паравиртуализации и виртуализации на основе ОС.

###### Ответ:

**Полная виртуализация** - *уже включает в себя гипервизор. В качестве гостевой можно использовать любую ОС.
Независимые ресурсы для каждой ВМ. 
По логике вещей должна быть более оптимальна, производительна и стабильна в работе(что = финансово дороже).*

**Паравиртуализация** - *необходима установка ОС и уже поверх нее гипервизор. 
В качестве гостевой можно использовать любую ОС.
Работает как процесс на хостовой машине. Соответственно, проблемы с производительностью одной ВМ,
могут отразиться на других ВМ,
а также и на хостовой машине.*

**Виртуализация на основе ОС** - *шарит ресурсы и ядро хостовой сестемы между контейнерами. 
В ВМ нельзя использовать отличное от ОС ядро. 
По сути это различные надстройки над namespace и cgroup(поправьте если я ошибаюсь)
Также как и паравиртуализация работает как отдельный процесс в ОС.*

## Задача 2

Выберите один из вариантов использования организации физических серверов, в зависимости от условий использования.

Организация серверов:
- физические сервера,
- паравиртуализация,
- виртуализация уровня ОС.

Условия использования:
- Высоконагруженная база данных, чувствительная к отказу.
- Различные web-приложения.
- Windows системы для использования бухгалтерским отделом.
- Системы, выполняющие высокопроизводительные расчеты на GPU.

Опишите, почему вы выбрали к каждому целевому использованию такую организацию.

###### Ответ:
- Высоконагруженная база данных, чувствительная к отказу.
    
На мой взгляд под БД лучше выделить физические сервера работающие в кластере, 
т.к. в случае использования виртуализации могут быть проблемы с производительностью, что может повлиять
на задержки ответа\записи бд, как следствия задержки того что конечный пользователь видит в frontend.
Ну и с точки зрнеия безопасности, т.к. зачастую в бд хранится конфиденциальная информация и если сэксплуатируют 
каку-либо уязвимость в гипервизоре, смогут добраться до БД.
Если коротко - то БД как сервис, сам по себе критичен.

- Различные web-приложения.

Под различные веб приложения можно вполне использовать виртуализацию на урвне ОС(контейнеризацию).
Проще разворачивать, автоматизировать, управлять(инфраструктура как код).


- Windows системы для использования бухгалтерским отделом.

Под Windows системы - паравиртуализация, т.к. зачасую нужны независимые ОС с различным набором служб и драйверов,
что уже исключает контейнеризацию. Также сюда не пожойдет вариант с физ. серверами, т.к. обычно в Win экосистеме
необходимо большое кол-во сервисов, которые должны быть логически разделены.

- Системы, выполняющие высокопроизводительные расчеты на GPU.

Под данный вид вычислений, подойдет контейнеризация. Можно распаралеллить разные вычисления 
между разными GPU или поделить 1 GPU мезду вычислениями для оптимизации. 
Соответственно физ. сервера и паравиртуализация, мимо.
Интересная статья на эту тему [тут](https://habr.com/ru/company/vk/blog/472928/).



## Задача 3

Выберите подходящую систему управления виртуализацией для предложенного сценария. Детально опишите ваш выбор.

Сценарии:

1. 100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований. Преимущественно Windows based инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного механизма создания резервных копий.
2. Требуется наиболее производительное бесплатное open source решение для виртуализации небольшой (20-30 серверов) инфраструктуры на базе Linux и Windows виртуальных машин.
3. Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows инфраструктуры.
4. Необходимо рабочее окружение для тестирования программного продукта на нескольких дистрибутивах Linux.

###### Ответ:
1. Если склоняться к тому что Windows-based машины преобладают, то можно выбрать Hyper-V, 
в целом задачи по репликации и РК Hyper-V - закрывает. Меньше геторогенность, проще управлять.
2. В случае opensource, можно использовать под эти цели Xen как стибильный и производительный гипервизор.
3. Как вариант можно использовать Hyper-V Server в редакции core(является бесплатным)
4. KVM - минимальный порог вхождения, производительность, opensource.


## Задача 4

Опишите возможные проблемы и недостатки гетерогенной среды виртуализации (использования нескольких систем управления виртуализацией одновременно) и что необходимо сделать для минимизации этих рисков и проблем. Если бы у вас был выбор, то создавали бы вы гетерогенную среду или нет? Мотивируйте ваш ответ примерами.

###### Ответ:

Недостатки при использовании геторогенной среды виртуализации: 
- порог вхождения
- сложность администрирования, кратная кол-ву сред. вирт.
- накладные расходы на осблуживание, также кратные кол-ву сред. вирт.
- возможные вендор-лок решения увеличивающие стоимость и невозможность использования с другой средой вирт.

Для минимизации, в случае если уже используется геторогенная среда:
- Использовать 'прослойку'([систему управления](https://www.solarwinds.com/virtualization-manager) различными гипервизорами из одной консоли). 
- Использовать такое ПО как Packer и Terraform
- Понимать различия и ограничения каждой платформы.
- Стараться использовать одинаковео hardware.

Бывает так, что ТЗ решением одного вендора не закрыть все необходимые требования, собственно так и получаются
геторогенные среды. Также геторогенные среды появляются когда бизесу необходимо
сэкономить средства.

В случае если все требования ТЗ закрываются, либо закрываются но не полностью(что-то придется автоматизирвоать самому),
я бы придерживался какого-то определенного решения виртуализации. Примеры выше.

Например Hyper-V так и не научилась нативно пробрасывать usb в гостевую ВМ, 
в отличии напр. от VMware.
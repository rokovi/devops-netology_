
# Домашнее задание к занятию "5.3. Введение. Экосистема. Архитектура. Жизненный цикл Docker контейнера"

## Задача 1

Сценарий выполения задачи:

- создайте свой репозиторий на https://hub.docker.com;
- выберете любой образ, который содержит веб-сервер Nginx;
- создайте свой fork образа;
- реализуйте функциональность:
запуск веб-сервера в фоне с индекс-страницей, содержащей HTML-код ниже:
```
<html>
<head>
Hey, Netology
</head>
<body>
<h1>I’m DevOps Engineer!</h1>
</body>
</html>
```
Опубликуйте созданный форк в своем репозитории и предоставьте ответ в виде ссылки на https://hub.docker.com/username_repo.

###### Ответ:
https://hub.docker.com/r/rokovi/websrv

## Задача 2

Посмотрите на сценарий ниже и ответьте на вопрос:
"Подходит ли в этом сценарии использование Docker контейнеров или лучше подойдет виртуальная машина, физическая машина? Может быть возможны разные варианты?"

Детально опишите и обоснуйте свой выбор.

--

Сценарий:

- Высоконагруженное монолитное java веб-приложение;
> Вообще Docker сам по себе больше для workflow микросервисов, но в целом ничего
> не мешает запустить в нем и монолитное приложение. Но, т.к. приложение монолитное
> и высоконагруженное, а значит сложно масштабируемое(нагрузка = масштабирование),
> то я бы оставил выбор на виртуальной машине. Проще предоставить запращиваемые 
> ресурсы в пиках(напр. динамическое выделине.)В случае с docker, масштабирование 
> монолитного приложения = запуск его копии со всеми его подсистемами, хотя по факту
> масштабировать нужно только конкретную подсистему. 
- Nodejs веб-приложение;
> Т.к. Nodejs это среда выполнения JavaScript на сервере, то для быстроты развертывания(
>зависимости, библиотеки и пр.)
> и в дальнейшем каких либо обновлений(кода), docker идеально подойдет под эту задачу.
- Мобильное приложение c версиями для Android и iOS;
> В любом случай что с Android, что с iOS, приложение выкатывается в магазины GPlay и AppStore, поэтому
> тут мы бессильны, в плане хостинга приложения в докере или вирт машине или физ.
> сервере. Но можем пойти в [CI](https://habr.com/ru/post/478110/) / [CD](https://habr.com/ru/company/psb/blog/583532/) (тесты, коммиты, сборки, репо, окружение и т.д.) для автоматизации проекта под эти платформы.
- Шина данных на базе Apache Kafka;
> [Kafka](https://tproger.ru/video/video-osnovy-apache-kafka/) активно используется в архитектуре микросервисов, 
> но т.к. как в случае большой нагрузки требовательна к ресурсам, чтобы не разворачивать
> (наприм.)100 докер контейнеров и не использовать в пустую простой по цпу или каких-либо др.
> ресурсов, я бы предпочел использовать гипервизор. В случае не прод. среды, можно
> и в докер.
- Elasticsearch кластер для реализации логирования продуктивного веб-приложения - три ноды elasticsearch, два logstash и две ноды kibana;
> Т.к. в случае с логами, быстрота чтения\записи не так важна, я бы остановился на docker.
> быстрое развертывание, изменение конфигурации, идемпотентность.
- Мониторинг-стек на базе Prometheus и Grafana;
> Т.к. в этом случае необходимо использовать 3 приложения(node_exporter, grafana, prometheus)
> я бы отсновился на docker для того-чтобы упростить себе жизнь в дальнейшем(управление
> изменение, обновление, зависимости)
- MongoDB, как основное хранилище данных для java-приложения;
> Завсит от множества факторов. Если не сильно нагруженная бд и нет жестких требований
> к данным(что-то может потеряться), то вполне можно использовать docker. В остальных
> случаях я бы остановился на вирт. машине.
- Gitlab сервер для реализации CI/CD процессов и приватный (закрытый) Docker Registry.
> На мой взгляд вирт. машина подошла бы больше всего, т.к. данные более\менее статичны(
> новые фичи в кодовую базу самого gitlaba не вносятся).

*P.S. с каждым из кейсом на практике дела не имел, поэтому не могу быть объективным
в этих вопросах.*


## Задача 3

- Запустите первый контейнер из образа ***centos*** c любым тэгом в фоновом режиме, подключив папку ```/data``` из текущей рабочей директории на хостовой машине в ```/data``` контейнера;
```bash
new0ne@new0ne-dp:~/data$ docker run -it -v ~/data:/data --name centos-netology -d centos
```
- Запустите второй контейнер из образа ***debian*** в фоновом режиме, подключив папку ```/data``` из текущей рабочей директории на хостовой машине в ```/data``` контейнера;
```bash
new0ne@new0ne-dp:~/data$ docker run -it -v ~/data:/data --name debian-netology -d debian
```
- Подключитесь к первому контейнеру с помощью ```docker exec``` и создайте текстовый файл любого содержания в ```/data```;
```bash
new0ne@new0ne-dp:~/data$ docker exec -it centos-netology sh -c "echo "some_text" > /data/file"
```
- Добавьте еще один файл в папку ```/data``` на хостовой машине;
```bash
new0ne@new0ne-dp:~/data$ echo "some_more_text" > ~/data/file2
```
- Подключитесь во второй контейнер и отобразите листинг и содержание файлов в ```/data``` контейнера.
```bash
root@4cb748e64df7:/# ls -lah /data/ && cat /data/file && cat /data/file2
total 16K
drwxrwxr-x 2 1000 1000 4.0K May  9 19:53 .
drwxr-xr-x 1 root root 4.0K May  9 19:45 ..
-rw-r--r-- 1 root root   10 May  9 19:49 file
-rw-rw-r-- 1 1000 1000   15 May  9 19:53 file2
some_text
some_more_text
```

## Задача 4 (*)

Воспроизвести практическую часть лекции самостоятельно.

Соберите Docker образ с Ansible, загрузите на Docker Hub и пришлите ссылку вместе с остальными ответами к задачам.

https://hub.docker.com/layers/ansible/rokovi/ansible/v2.10/images/sha256-7f58f9d4e16abbc071fc3b974a0c0c9c36d4ea23a7328870132557149a505276?context=repo